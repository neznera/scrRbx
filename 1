--[[
    Простой и плавный аимбот на голову (постоянно активен)
    - Плавное наведение (регулируется Smoothness)
    - TeamCheck (не цепляет своих)
    - FOV (радиус действия на экране)
    - Работает без нажатия клавиш
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- Настройки (можно менять прямо здесь)
local Settings = {
    TeamCheck = true,           -- true = не наводиться на союзников
    Smoothness = 0.2,           -- 0 = мгновенно, 0.5 = медленно, 1 = очень плавно
    FOV = 200,                  -- радиус поиска цели на экране (в пикселях)
}

-- Проверка: враг ли?
local function IsEnemy(player)
    if player == LocalPlayer then return false end
    if Settings.TeamCheck and player.Team and LocalPlayer.Team then
        return player.Team ~= LocalPlayer.Team
    end
    return true
end

-- Поиск ближайшего врага с видимой головой
local function GetClosestEnemy()
    local mousePos = UserInputService:GetMouseLocation()
    local closest = nil
    local closestDist = Settings.FOV

    for _, player in ipairs(Players:GetPlayers()) do
        if IsEnemy(player) and player.Character then
            local hum = player.Character:FindFirstChild("Humanoid")
            local head = player.Character:FindFirstChild("Head")
            if hum and hum.Health > 0 and head then
                local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
                if onScreen then
                    local dist = (Vector2.new(pos.X, pos.Y) - mousePos).Magnitude
                    if dist < closestDist then
                        closestDist = dist
                        closest = head
                    end
                end
            end
        end
    end
    return closest
end

-- Плавное движение мыши
local function MoveMouseSmooth(targetX, targetY)
    local current = UserInputService:GetMouseLocation()
    local delta = Vector2.new(targetX - current.X, targetY - current.Y)
    if delta.Magnitude < 1 then return end

    local move = delta * Settings.Smoothness
    -- Поддержка разных экзекуторов
    if mousemoverel then
        mousemoverel(move.X, move.Y)
    elseif syn and syn.input then
        syn.input.MouseMove(move.X, move.Y)
    elseif VirtualInputManager then
        VirtualInputManager:SendMouseMoveEvent(move.X, move.Y, false)
    end
end

-- Главный цикл (каждый кадр)
RunService.RenderStepped:Connect(function()
    local target = GetClosestEnemy()
    if target then
        local pos = Camera:WorldToViewportPoint(target.Position)
        MoveMouseSmooth(pos.X, pos.Y)
    end
end)

print("✅ Плавный аимбот на голову запущен. Настройки: TeamCheck = " .. tostring(Settings.TeamCheck) .. ", FOV = " .. Settings.FOV .. ", Smoothness = " .. Settings.Smoothness)
